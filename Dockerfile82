FROM --platform=linux/amd64 webdevops/php-nginx-dev:8.2

RUN apt-get update && apt-get install -y \
    libatk-bridge2.0-0 \
    libnss3 \
    libxss1 \
    libasound2 \
    libgtk-3-0

RUN apt-get update && apt-get install -y \
    libx11-xcb1 \
    libasound2 \
    gconf2 \
    libdrm2 \
    libice6 \
    libsm6 \
    libgbm-dev

RUN docker-php-ext-enable xdebug

# Install NodeJs
RUN curl -sL https://deb.nodesource.com/setup_21.x| bash -
RUN apt-get install -y nodejs

RUN npm install -g npm
RUN npm install -g yarn

# Install OpenSSH and set the password for root to "Docker!". In this example, "apk add" is the install instruction for an Alpine Linux-based image.
RUN apt-install openssh-server \
    && echo "root:Docker!" | chpasswd

COPY --chown=application:application  . /app
WORKDIR /app
USER application

EXPOSE 80 443 2222 9000 9003
